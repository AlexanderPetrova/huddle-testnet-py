# Huddle01 Тестнет Автоматизация

Бот на Python, предназначенный для автоматического участия в комнатах тестнета Huddle01 с использованием нескольких аккаунтов. Бот обрабатывает аутентификацию, управление сессиями, WebSocket-соединения и обеспечивает присутствие в указанной комнате Huddle01.

## Особенности

* **Поддержка нескольких аккаунтов:** Загрузка нескольких приватных ключей Ethereum для подключения к комнате с разными участниками.
* **Автоматическое подключение к комнате:** Автоматически обрабатывает процесс входа в комнату Huddle01.
* **Аутентификация кошелька:** Реализация механизма подписи challenge-response для входа в Huddle01.
* **Управление сессиями:** Сохраняет отображаемые имена и user-agent'ы для аккаунтов между сессиями (`session.json`).
* **Случайные User-Agent'ы:** Генерирует случайные, но правдоподобные user-agent'ы для каждого аккаунта.
* **WebSocket-соединение:** Устанавливает и управляет соединениями WebSocket для взаимодействия в комнате.
* **Корректное завершение работы:** Обрабатывает `SIGINT` (Ctrl+C) и `SIGTERM` для чистого завершения работы.
* **Мониторинг соединений и автоматическое переподключение:** Отслеживает активные соединения и пытается восстановить их при потере.
* **Настраиваемое использование аккаунтов:** Указание количества аккаунтов или использование всех из `private_key.txt`.
* **Динамический ввод ID комнаты:** Принимает ID комнаты напрямую или извлекает его из полной ссылки на комнату Huddle01.
* **Участие в тестнете:** Функциональность для взаимодействия с возможностями тестнета (например, сбор баллов).

## Предварительные требования

* Python 3.8 или выше
* `pip` (менеджер пакетов Python)

## Установка и настройка

1. **Клонирование репозитория:**
   ```bash
   git clone https://github.com/AlexanderPetrova/huddle-testnet-py.git
   cd huddle-testnet-py
   ```
### Создание и активация виртуального окружения (рекомендуется):

```bash
python -m venv venv
```
#### Для Windows:
```bash
venv\Scripts\activate
```
#### Для macOS/Linux:
```bash
source venv/bin/activate
```

### Установка зависимостей:

Убедитесь, что файл `requirements.txt` выглядит следующим образом перед установкой:

```txt
aiohttp==3.9.5
websockets==12.0
eth-account==0.12.0
Faker==25.8.0
colorama==0.4.6
brotli==1.1.0
```

#### Затем установите:

```bash
pip install -r requirements.txt
```

### Конфигурация `private_key.txt`:

Создайте файл `private_key.txt` в корневом каталоге проекта (на одном уровне с main.py).

Добавьте в него приватные ключи Ethereum, по одному ключу на строку.

Ключи могут быть с префиксом 0x или без него.

#### Пример:

```txt
0xabcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890
fedcba0987654321fedcba0987654321fedcba0987654321fedcba0987654321
```

#### session.json:

Этот файл будет создан и обновлён автоматически скриптом account_manager.py при первом запуске с новыми ключами.

Он хранит имена и user-agent'ы, связанные с каждым ключом. Обычно его не нужно редактировать вручную.

#### config.py:

- Этот файл содержит API-адреса и NEXTJS_BUILD_ID.

- NEXTJS_BUILD_ID: используется для получения данных комнаты. Если Huddle01 обновит фронтенд, этот идентификатор может измениться, и его потребуется обновить вручную.

Использование
Запустите скрипт main.py из корня проекта.

### Базовый синтаксис:

```bash
python main.py [room_id_or_url] [-n num_accounts]
```

#### Аргументы:
room_id_or_url (необязательный):
ID комнаты Huddle01 (например, abc-defg-hij) или полный URL комнаты (например, https://huddle01.app/room/abc-defg-hij).
Если не указано, скрипт запросит его при запуске.

`-n num_accounts, --num_accounts num_accounts (необязательный)`:
Количество аккаунтов, которое следует использовать из `private_key.txt`.
Если указано 0 или не указано, будут использованы все доступные ключи.
Если указано положительное число, будет использовано соответствующее количество аккаунтов.
Если аккаунтов меньше, чем указано, появится предупреждение, и будут использованы все доступные.

#### Примеры:
Войти в комнату по ID с использованием всех аккаунтов:

```bash
python main.py abc-defg-hij
```

### Войти в комнату по URL с использованием первых 5 аккаунтов:

```bash
python main.py https://huddle01.app/room/abc-defg-hij -n 5
```

### Запуск без аргументов (будет запрошен ID комнаты):

```bash
python main.py
```

Бот выведет лог действий в консоль, включая информацию о подключениях, ошибках и событиях WebSocket. Нажмите Ctrl+C для завершения.

### Структура проекта
```yaml
HUDDLE-TESTNET-BOT/
│── private_key.txt
│── session.json
│── last_room_id.json
│
├── huddle_bot/
│   ├── __init__.py
│   ├── config.py
│   ├── core/
│   │   ├── __init__.py
│   │   ├── account_manager.py
│   │   └── controller.py
│   ├── services/
│   │   ├── __init__.py
│   │   ├── api_client.py
│   │   └── websocket_client.py
│   └── utils/
│       ├── __init__.py
│       └── utils.py
│
├── main.py
├── .gitignore
├── README.md
└── requirements.txt
```

### Зависимости
Основные зависимости указаны в requirements.txt и включают:

- aiohttp: для асинхронных HTTP-запросов.
- websockets: для WebSocket-соединений.
- eth-account: для работы с Ethereum аккаунтами и подписями.
- Faker: для генерации случайных имён.
- colorama: для цветного вывода в консоль.

## Вклад
Вклады приветствуются! Открывайте Pull Request или Issue для багов, предложений и улучшений.

## Отказ от ответственности
Этот бот предназначен для образовательных и тестовых целей, особенно для взаимодействия с тестнетом Huddle01.

Пользователи несут полную ответственность за соответствие использования этого бота условиям сервиса Huddle01 и любым применимым правилам платформ.

Разработчики не несут ответственности за неправильное использование, блокировку аккаунтов или другие последствия, вызванные использованием этого бота.

## Лицензия
MIT License — проект без лицензии ("This project is unlicensed.")